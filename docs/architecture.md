# AI Needs æ¶æ„è®¾è®¡æ–‡æ¡£

> æ·±å…¥ç†è§£ç³»ç»Ÿæ¶æ„ã€è®¾è®¡å†³ç­–å’Œå¯æ‰©å±•æ€§

## ğŸ“‹ ç›®å½•

- [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
- [æŠ€æœ¯é€‰å‹ç†ç”±](#æŠ€æœ¯é€‰å‹ç†ç”±)
- [æ ¸å¿ƒè®¾è®¡å†³ç­–](#æ ¸å¿ƒè®¾è®¡å†³ç­–)
- [æ•°æ®æµä¸äº¤äº’](#æ•°æ®æµä¸äº¤äº’)
- [å¯æ‰©å±•æ€§è®¾è®¡](#å¯æ‰©å±•æ€§è®¾è®¡)
- [å®‰å…¨æ€§è€ƒè™‘](#å®‰å…¨æ€§è€ƒè™‘)
- [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç”¨æˆ·æµè§ˆå™¨                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React 18 + TypeScript + Ant Design + Zustand           â”‚  â”‚
â”‚  â”‚  - æ–‡æ¡£ä¸Šä¼ ç®¡ç†                                          â”‚  â”‚
â”‚  â”‚  - å®æ—¶WebSocketé€šä¿¡                                     â”‚  â”‚
â”‚  â”‚  - å¤šé˜¶æ®µæµç¨‹å¯è§†åŒ–                                      â”‚  â”‚
â”‚  â”‚  - äººå·¥ç¡®è®¤æœºåˆ¶                                          â”‚  â”‚
â”‚  â”‚  - å†å²è®°å½•ç®¡ç†ï¼ˆlocalStorageï¼‰                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTP/REST                 â”‚ WebSocket
               â”‚                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nginx åå‘ä»£ç†                              â”‚
â”‚  - é™æ€æ–‡ä»¶æœåŠ¡                                               â”‚
â”‚  - APIè·¯ç”±è½¬å‘                                                â”‚
â”‚  - WebSocketè¿æ¥ä»£ç†                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                FastAPI åç«¯æœåŠ¡                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  API è·¯ç”±å±‚                                              â”‚ â”‚
â”‚  â”‚  - æ–‡æ¡£ä¸Šä¼  (/api/uploads)                              â”‚ â”‚
â”‚  â”‚  - ä¼šè¯ç®¡ç† (/api/sessions)                             â”‚ â”‚
â”‚  â”‚  - ç»“æœå¯¼å‡º (/api/exports)                              â”‚ â”‚
â”‚  â”‚  - WebSocketç«¯ç‚¹ (/ws/sessions/{id})                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  å·¥ä½œæµç¼–æ’å±‚ (Orchestrator)                            â”‚ â”‚
â”‚  â”‚  - SessionWorkflowExecution: 4é˜¶æ®µæ™ºèƒ½ä½“åä½œç¼–æ’        â”‚ â”‚
â”‚  â”‚  - æ–‡æ¡£é¢„å¤„ç†ï¼ˆæ–‡æœ¬æå–/VLè¯†åˆ«ï¼‰                        â”‚ â”‚
â”‚  â”‚  - é˜¶æ®µç»“æœå¤„ç†ä¸WebSocketå¹¿æ’­                          â”‚ â”‚
â”‚  â”‚  - äººå·¥ç¡®è®¤ç­‰å¾…æœºåˆ¶                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  LLM å®¢æˆ·ç«¯å±‚                                           â”‚ â”‚
â”‚  â”‚  - AutoGen Runner: å¤šæ™ºèƒ½ä½“å·¥ä½œæµè¿è¡Œå™¨                 â”‚ â”‚
â”‚  â”‚  - Multimodal Client: å¤šæ¨¡æ€VLæ¨¡å‹å®¢æˆ·ç«¯                â”‚ â”‚
â”‚  â”‚  - Vision Client: è§†è§‰è¯†åˆ«å®¢æˆ·ç«¯ï¼ˆå¸¦ç¼“å­˜ï¼‰              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  æ•°æ®è®¿é—®å±‚ (Repository)                                â”‚ â”‚
â”‚  â”‚  - Session Repository: ä¼šè¯CRUD                         â”‚ â”‚
â”‚  â”‚  - Document Repository: æ–‡æ¡£CRUD                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                          â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SQLAlchemy     â”‚        â”‚  Redisç¼“å­˜      â”‚
    â”‚  (å¼‚æ­¥ORM)      â”‚        â”‚  - WebSocketäº‹ä»¶â”‚
    â”‚  - Session      â”‚        â”‚  - VLè¯†åˆ«ç¼“å­˜   â”‚
    â”‚  - Document     â”‚        â”‚  - ç¡®è®¤çŠ¶æ€     â”‚
    â”‚  - AgentRun     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  - SessionResultâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ•°æ®åº“         â”‚
    â”‚  - SQLite (å¼€å‘)â”‚
    â”‚  - PostgreSQL   â”‚
    â”‚    (ç”Ÿäº§)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¤–éƒ¨æœåŠ¡                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é€šä¹‰åƒé—® API (DashScope)                                â”‚  â”‚
â”‚  â”‚  - qwen3-vl-flash: å¿«é€Ÿå›¾ç‰‡è¯†åˆ«                         â”‚  â”‚
â”‚  â”‚  - qwen-vl-ocr-latest: PDFä¸“ç”¨OCR                       â”‚  â”‚
â”‚  â”‚  - qwen3-next-80b-a3b-instruct: æ–‡æœ¬ç”Ÿæˆ                â”‚  â”‚
â”‚  â”‚  - qwen-plus: é€šç”¨å¯¹è¯æ¨¡å‹                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æŠ€æœ¯é€‰å‹ç†ç”±

### åç«¯æŠ€æœ¯é€‰å‹

#### 1. FastAPI vs Flask/Django

**é€‰æ‹© FastAPI çš„ç†ç”±**:
- âœ… **åŸç”Ÿå¼‚æ­¥æ”¯æŒ**: åŸºäº ASGIï¼Œå¤©ç„¶æ”¯æŒ async/awaitï¼Œé€‚åˆ I/O å¯†é›†å‹ä»»åŠ¡ï¼ˆLLMè°ƒç”¨ã€æ•°æ®åº“æŸ¥è¯¢ï¼‰
- âœ… **é«˜æ€§èƒ½**: æ€§èƒ½æ¥è¿‘ Node.js å’Œ Go
- âœ… **è‡ªåŠ¨APIæ–‡æ¡£**: åŸºäº OpenAPI è‡ªåŠ¨ç”Ÿæˆ Swagger UI
- âœ… **ç±»å‹å®‰å…¨**: Pydantic æä¾›å¼ºå¤§çš„æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- âœ… **ç°ä»£åŒ–**: Python 3.10+ ç±»å‹æç¤ºå‹å¥½

#### 2. AutoGen vs LangChain

**é€‰æ‹© AutoGen çš„ç†ç”±**:
- âœ… **å¤šæ™ºèƒ½ä½“åä½œ**: åŸç”Ÿæ”¯æŒå¤šä¸ªæ™ºèƒ½ä½“ä¹‹é—´çš„å¯¹è¯å’Œåä½œ
- âœ… **çµæ´»çš„å·¥ä½œæµ**: å¯ä»¥è½»æ¾å®ç°é¡ºåºæ‰§è¡Œã€å¹¶è¡Œæ‰§è¡Œã€å¾ªç¯æ‰§è¡Œ
- âœ… **äººå·¥ç¡®è®¤æœºåˆ¶**: æ”¯æŒäººå·¥å¹²é¢„å’Œç¡®è®¤
- âœ… **OpenAIå…¼å®¹**: æ”¯æŒæ‰€æœ‰OpenAIå…¼å®¹çš„LLM API

#### 3. SQLAlchemy vs Tortoise ORM

**é€‰æ‹© SQLAlchemy çš„ç†ç”±**:
- âœ… **æˆç†Ÿç¨³å®š**: ä¸šç•Œæœ€æˆç†Ÿçš„Python ORM
- âœ… **å¼‚æ­¥æ”¯æŒ**: 2.0ç‰ˆæœ¬å®Œæ•´æ”¯æŒ async/await
- âœ… **çµæ´»æ€§**: æ”¯æŒå£°æ˜å¼å’Œå‘½ä»¤å¼ä¸¤ç§é£æ ¼
- âœ… **è¿ç§»å·¥å…·**: Alembic æä¾›å®Œå–„çš„æ•°æ®åº“è¿ç§»æ”¯æŒ

#### 4. Redis vs Memcached

**é€‰æ‹© Redis çš„ç†ç”±**:
- âœ… **æ•°æ®ç»“æ„ä¸°å¯Œ**: æ”¯æŒå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å“ˆå¸Œè¡¨ç­‰å¤šç§æ•°æ®ç»“æ„
- âœ… **æŒä¹…åŒ–**: æ”¯æŒRDBå’ŒAOFä¸¤ç§æŒä¹…åŒ–æ–¹å¼
- âœ… **å‘å¸ƒè®¢é˜…**: æ”¯æŒWebSocketäº‹ä»¶å¹¿æ’­
- âœ… **è¿‡æœŸç­–ç•¥**: è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®

### å‰ç«¯æŠ€æœ¯é€‰å‹

#### 1. React vs Vue/Angular

**é€‰æ‹© React çš„ç†ç”±**:
- âœ… **ç”Ÿæ€ä¸°å¯Œ**: npmåŒ…æ•°é‡æœ€å¤šï¼Œç¤¾åŒºæœ€æ´»è·ƒ
- âœ… **çµæ´»æ€§**: æ¸è¿›å¼æ¶æ„ï¼Œå¯ä»¥æŒ‰éœ€å¼•å…¥åŠŸèƒ½
- âœ… **æ€§èƒ½ä¼˜å¼‚**: è™šæ‹ŸDOM + Fiberæ¶æ„
- âœ… **TypeScriptæ”¯æŒ**: ç±»å‹å®šä¹‰å®Œå–„

#### 2. Zustand vs Redux/MobX

**é€‰æ‹© Zustand çš„ç†ç”±**:
- âœ… **è½»é‡çº§**: ä»…1KBï¼Œæ— éœ€ProvideråŒ…è£¹
- âœ… **ç®€å•æ˜“ç”¨**: APIç®€æ´ï¼Œå­¦ä¹ æˆæœ¬ä½
- âœ… **æ€§èƒ½ä¼˜å¼‚**: åŸºäºè®¢é˜…æ¨¡å¼ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
- âœ… **TypeScriptå‹å¥½**: ç±»å‹æ¨å¯¼å®Œå–„

#### 3. Ant Design vs Material-UI

**é€‰æ‹© Ant Design çš„ç†ç”±**:
- âœ… **ä¼ä¸šçº§**: ä¸“ä¸ºåå°ç®¡ç†ç³»ç»Ÿè®¾è®¡
- âœ… **ç»„ä»¶ä¸°å¯Œ**: å¼€ç®±å³ç”¨çš„é«˜è´¨é‡ç»„ä»¶
- âœ… **ä¸­æ–‡æ–‡æ¡£**: ä¸­æ–‡æ–‡æ¡£å®Œå–„ï¼Œé€‚åˆå›½å†…å›¢é˜Ÿ
- âœ… **è®¾è®¡è§„èŒƒ**: æä¾›å®Œæ•´çš„è®¾è®¡è¯­è¨€

#### 4. Socket.IO vs åŸç”ŸWebSocket

**é€‰æ‹© Socket.IO çš„ç†ç”±**:
- âœ… **æ–­çº¿é‡è¿**: è‡ªåŠ¨é‡è¿æœºåˆ¶
- âœ… **å¿ƒè·³æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹è¿æ¥çŠ¶æ€
- âœ… **è·¨æµè§ˆå™¨**: å…¼å®¹æ€§å¥½ï¼Œæ”¯æŒé™çº§åˆ°è½®è¯¢
- âœ… **æˆ¿é—´æœºåˆ¶**: æ”¯æŒåˆ†ç»„å¹¿æ’­

---

## ğŸ”‘ æ ¸å¿ƒè®¾è®¡å†³ç­–

### 1. ä¸ºä»€ä¹ˆé‡‡ç”¨4é˜¶æ®µå·¥ä½œæµï¼Ÿ

**è®¾è®¡ç†å¿µ**: æ¨¡æ‹ŸçœŸå®çš„éœ€æ±‚åˆ†æå’Œæµ‹è¯•æµç¨‹

```
éœ€æ±‚åˆ†æå¸ˆ â†’ æµ‹è¯•å·¥ç¨‹å¸ˆ â†’ è´¨é‡è¯„å®¡ä¸“å®¶ â†’ æµ‹è¯•è¡¥å…¨å·¥ç¨‹å¸ˆ
```

**ä¼˜ç‚¹**:
- âœ… **èŒè´£æ˜ç¡®**: æ¯ä¸ªæ™ºèƒ½ä½“ä¸“æ³¨äºä¸€ä¸ªä»»åŠ¡
- âœ… **è´¨é‡ä¿è¯**: å¤šè½®è¯„å®¡å’Œè¡¥å…¨ç¡®ä¿æµ‹è¯•ç”¨ä¾‹å®Œæ•´æ€§
- âœ… **å¯è¿½æº¯æ€§**: æ¯ä¸ªé˜¶æ®µçš„è¾“å‡ºéƒ½è¢«è®°å½•ï¼Œä¾¿äºå®¡è®¡
- âœ… **å¯æ‰©å±•æ€§**: å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„é˜¶æ®µï¼ˆå¦‚å®‰å…¨æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ï¼‰

**ç¼ºç‚¹ä¸æƒè¡¡**:
- âŒ **æ—¶é—´è¾ƒé•¿**: 4ä¸ªé˜¶æ®µä¸²è¡Œæ‰§è¡Œï¼Œæ€»è€—æ—¶è¾ƒé•¿
- âš–ï¸ **æƒè¡¡**: å¯ä»¥é€šè¿‡å¹¶è¡Œæ‰§è¡Œéƒ¨åˆ†é˜¶æ®µä¼˜åŒ–ï¼ˆå¦‚åŒæ—¶ç”ŸæˆåŠŸèƒ½æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ç”¨ä¾‹ï¼‰

---

### 2. ä¸ºä»€ä¹ˆä½¿ç”¨Redisç¼“å­˜ç¡®è®¤çŠ¶æ€ï¼Ÿ

**é—®é¢˜**: å¦‚ä½•å®ç°äººå·¥ç¡®è®¤æœºåˆ¶ï¼Ÿ

**æ–¹æ¡ˆå¯¹æ¯”**:

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| æ•°æ®åº“è½®è¯¢ | æŒä¹…åŒ– | æ€§èƒ½å·®ï¼Œæ•°æ®åº“å‹åŠ›å¤§ |
| WebSocketåŒå‘é€šä¿¡ | å®æ—¶æ€§å¼º | å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶æ— æ³•æ¢å¤ |
| **Redisç¼“å­˜** | **æ€§èƒ½å¥½ï¼Œæ”¯æŒè¿‡æœŸ** | **éœ€è¦é¢å¤–æœåŠ¡** |

**æœ€ç»ˆé€‰æ‹©**: Redisç¼“å­˜
- âœ… **æ€§èƒ½ä¼˜å¼‚**: å†…å­˜æ“ä½œï¼Œè½®è¯¢é—´éš”1ç§’æ— å‹åŠ›
- âœ… **è‡ªåŠ¨è¿‡æœŸ**: è®¾ç½®5åˆ†é’ŸTTLï¼Œé¿å…å†…å­˜æ³„æ¼
- âœ… **ç®€å•å¯é **: æ— éœ€å¤æ‚çš„æ¶ˆæ¯é˜Ÿåˆ—

**å®ç°ä»£ç **:
```python
# å·¥ä½œæµç­‰å¾…ç¡®è®¤
for _ in range(300):  # 5åˆ†é’Ÿè¶…æ—¶
    await asyncio.sleep(1)
    confirmation = await session_events.get_confirmation(session_id)
    if confirmation and confirmation.get("confirmed"):
        return True
return False  # è¶…æ—¶
```

---

### 3. ä¸ºä»€ä¹ˆå‰ç«¯å†å²è®°å½•å­˜localStorageè€Œä¸æ˜¯åç«¯ï¼Ÿ

**è®¾è®¡ç†å¿µ**: é™ä½åç«¯å¤æ‚åº¦ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

**ä¼˜ç‚¹**:
- âœ… **ç¦»çº¿å¯ç”¨**: å³ä½¿åç«¯æŒ‚æ‰ï¼Œç”¨æˆ·ä»èƒ½æŸ¥çœ‹å†å²è®°å½•
- âœ… **å‡è½»åç«¯å‹åŠ›**: ä¸éœ€è¦é¢å¤–çš„å†å²è®°å½•è¡¨å’ŒæŸ¥è¯¢æ¥å£
- âœ… **å³æ—¶åŠ è½½**: æ— éœ€ç½‘ç»œè¯·æ±‚ï¼Œç§’å¼€
- âœ… **ç”¨æˆ·éšç§**: æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸ä¸Šä¼ æœåŠ¡å™¨

**ç¼ºç‚¹ä¸æƒè¡¡**:
- âŒ **æ— æ³•è·¨è®¾å¤‡**: æ¢è®¾å¤‡æˆ–æ¸…é™¤æµè§ˆå™¨æ•°æ®åä¸¢å¤±
- âš–ï¸ **æƒè¡¡**: å¯¹äºéœ€æ±‚åˆ†æåœºæ™¯ï¼Œç”¨æˆ·é€šå¸¸åœ¨åŒä¸€è®¾å¤‡ä¸Šå·¥ä½œï¼Œå¯ä»¥æ¥å—
- âš–ï¸ **æœªæ¥ä¼˜åŒ–**: å¯ä»¥æ·»åŠ "å¯¼å‡ºå†å²è®°å½•"åŠŸèƒ½ï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨å¤‡ä»½

---

### 4. æµå¼è¾“å‡º vs éæµå¼è¾“å‡ºçš„æƒè¡¡

**æµå¼è¾“å‡ºä¼˜ç‚¹**:
- âœ… **å³æ—¶åé¦ˆ**: ç”¨æˆ·çœ‹åˆ°"æ‰“å­—æœº"æ•ˆæœï¼Œæ„ŸçŸ¥åˆ°ç³»ç»Ÿåœ¨å·¥ä½œ
- âœ… **é™ä½ç­‰å¾…ç„¦è™‘**: é•¿æ—¶é—´LLMè°ƒç”¨æ—¶ï¼Œç”¨æˆ·ä¸ä¼šè§‰å¾—ç³»ç»Ÿå¡ä½

**æµå¼è¾“å‡ºç¼ºç‚¹**:
- âŒ **å‰ç«¯å¤æ‚åº¦**: éœ€è¦å¤„ç†æ¶ˆæ¯è¿½åŠ é€»è¾‘ï¼Œé¿å…é‡å¤
- âŒ **åç«¯å¤æ‚åº¦**: éœ€è¦ä½¿ç”¨OpenAIæµå¼APIï¼Œä¸èƒ½ç›´æ¥ç”¨AutoGen

**æœ€ç»ˆæ–¹æ¡ˆ**: **æ··åˆæ¨¡å¼**
- **éœ€æ±‚åˆ†æã€æµ‹è¯•ç”Ÿæˆã€è´¨é‡è¯„å®¡ã€ç”¨ä¾‹è¡¥å…¨**: ä½¿ç”¨æµå¼è¾“å‡ºï¼ˆç”¨æˆ·ç­‰å¾…æ—¶é—´é•¿ï¼‰
- **ç¡®è®¤æ¶ˆæ¯ã€ç³»ç»Ÿæ¶ˆæ¯**: éæµå¼è¾“å‡ºï¼ˆå†…å®¹ç®€çŸ­ï¼‰

---

### 5. ä¸ºä»€ä¹ˆæ”¯æŒå¤šæ¨¡æ€åˆ†æå¼€å…³ï¼Ÿ

**é—®é¢˜**: VLæ¨¡å‹ç›´æ¥åˆ†æå›¾ç‰‡ vs å…ˆOCRå†åˆ†ææ–‡æœ¬

**æ–¹æ¡ˆå¯¹æ¯”**:

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **æ–‡æœ¬æ¨¡å¼**ï¼ˆOCRé¢„å¤„ç†ï¼‰ | æˆæœ¬ä½ï¼Œé€Ÿåº¦å¿« | ä¸¢å¤±è§†è§‰ä¿¡æ¯ï¼ˆé¢œè‰²ã€å¸ƒå±€ã€ç®­å¤´ï¼‰ | çº¯æ–‡æœ¬æ–‡æ¡£ï¼Œç®€å•è¡¨æ ¼ |
| **å¤šæ¨¡æ€æ¨¡å¼**ï¼ˆç›´æ¥åˆ†æï¼‰ | ä¿ç•™å®Œæ•´è§†è§‰ä¿¡æ¯ | æˆæœ¬é«˜ï¼Œé€Ÿåº¦æ…¢ | æµç¨‹å›¾ã€UIåŸå‹ã€æ¶æ„å›¾ |

**è®¾è®¡å†³ç­–**: æä¾›é…ç½®å¼€å…³ï¼Œè®©ç”¨æˆ·æ ¹æ®æ–‡æ¡£ç±»å‹é€‰æ‹©

```bash
# æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼šæˆæœ¬ä½ï¼Œé€‚åˆçº¯æ–‡æœ¬éœ€æ±‚æ–‡æ¡£
ANALYSIS_MULTIMODAL_ENABLED=false

# å¤šæ¨¡æ€æ¨¡å¼ï¼šä¿ç•™è§†è§‰ä¿¡æ¯ï¼Œé€‚åˆæµç¨‹å›¾/UIåŸå‹
ANALYSIS_MULTIMODAL_ENABLED=true
```

---

## ğŸ”„ æ•°æ®æµä¸äº¤äº’

### å®Œæ•´æ•°æ®æµå›¾

```
1. ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£
   â”œâ”€> POST /api/uploads
   â”œâ”€> è®¡ç®—SHA256 checksum
   â”œâ”€> æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨ï¼ˆå»é‡ï¼‰
   â”œâ”€> ä¿å­˜åˆ° /tmp/uploads/
   â””â”€> åˆ›å»º Document è®°å½•

2. ç”¨æˆ·ç‚¹å‡»"å¼€å§‹åˆ†æ"
   â”œâ”€> POST /api/sessions {document_ids: [...]}
   â”œâ”€> åˆ›å»º Session è®°å½•
   â”œâ”€> åå°å¯åŠ¨å·¥ä½œæµ workflow.launch(session_id)
   â””â”€> è¿”å› session_id

3. å‰ç«¯å»ºç«‹WebSocketè¿æ¥
   â”œâ”€> WebSocket /ws/sessions/{session_id}
   â”œâ”€> åç«¯å‘é€å†å²äº‹ä»¶ï¼ˆRedisç¼“å­˜ï¼‰
   â””â”€> ä¿æŒè¿æ¥

4. å·¥ä½œæµæ‰§è¡Œï¼ˆåå°çº¿ç¨‹ï¼‰
   â”œâ”€> é˜¶æ®µ1: éœ€æ±‚åˆ†æ
   â”‚   â”œâ”€> å‡†å¤‡æ–‡æ¡£æ•°æ®ï¼ˆæå–æ–‡æœ¬/VLè¯†åˆ«ï¼‰
   â”‚   â”œâ”€> è°ƒç”¨ AutoGen éœ€æ±‚åˆ†æå¸ˆ
   â”‚   â”œâ”€> æå–JSONç»“æœ
   â”‚   â”œâ”€> å­˜å‚¨åˆ° Redis + å¹¿æ’­WebSocket
   â”‚   â””â”€> ç­‰å¾…äººå·¥ç¡®è®¤ï¼ˆè½®è¯¢Redisï¼‰
   â”œâ”€> é˜¶æ®µ2: æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
   â”‚   â”œâ”€> è°ƒç”¨ AutoGen æµ‹è¯•å·¥ç¨‹å¸ˆ
   â”‚   â”œâ”€> è§£æMarkdownä¸ºJSON
   â”‚   â”œâ”€> å­˜å‚¨åˆ° Redis + å¹¿æ’­WebSocket
   â”‚   â””â”€> ç­‰å¾…äººå·¥ç¡®è®¤
   â”œâ”€> é˜¶æ®µ3: è´¨é‡è¯„å®¡
   â”‚   â”œâ”€> è°ƒç”¨ AutoGen è´¨é‡è¯„å®¡ä¸“å®¶
   â”‚   â”œâ”€> è§£æMarkdownä¸ºç»“æ„åŒ–æ•°æ®
   â”‚   â”œâ”€> å­˜å‚¨åˆ° Redis + å¹¿æ’­WebSocket
   â”‚   â””â”€> ç­‰å¾…äººå·¥ç¡®è®¤
   â”œâ”€> é˜¶æ®µ4: ç”¨ä¾‹è¡¥å…¨
   â”‚   â”œâ”€> è°ƒç”¨ AutoGen æµ‹è¯•è¡¥å…¨å·¥ç¨‹å¸ˆ
   â”‚   â”œâ”€> è§£æMarkdownä¸ºJSON
   â”‚   â”œâ”€> å­˜å‚¨åˆ° Redis + å¹¿æ’­WebSocket
   â”‚   â””â”€> ç­‰å¾…äººå·¥ç¡®è®¤
   â””â”€> å®Œæˆ
       â”œâ”€> åˆå¹¶æµ‹è¯•ç”¨ä¾‹ï¼ˆé˜¶æ®µ2 + é˜¶æ®µ4ï¼‰
       â”œâ”€> ä¿å­˜åˆ° SessionResult è¡¨
       â”œâ”€> å¹¿æ’­ completed äº‹ä»¶
       â””â”€> æ›´æ–° Session çŠ¶æ€ä¸º completed

5. å‰ç«¯å¤„ç†WebSocketæ¶ˆæ¯
   â”œâ”€> æ¥æ”¶ agent_message
   â”œâ”€> æ ¹æ® is_streaming æ ‡å¿—è¿½åŠ æˆ–åˆ›å»ºç»“æœ
   â”œâ”€> æ›´æ–°è¿›åº¦æ¡
   â”œâ”€> è‡ªåŠ¨åˆ‡æ¢åˆ°æ–°é˜¶æ®µ
   â”œâ”€> æ˜¾ç¤ºç¡®è®¤å¡ç‰‡ï¼ˆå¦‚æœ needs_confirmation=trueï¼‰
   â””â”€> ä¿å­˜åˆ° localStorageï¼ˆå¦‚æœ completedï¼‰

6. ç”¨æˆ·ç¡®è®¤
   â”œâ”€> ç‚¹å‡»"ç¡®è®¤"æŒ‰é’®
   â”œâ”€> å‘é€ WebSocket æ¶ˆæ¯ {type: "confirm_agent", confirmed: true}
   â”œâ”€> åç«¯æ¥æ”¶å¹¶å­˜å‚¨åˆ° Redis
   â””â”€> å·¥ä½œæµç»§ç»­æ‰§è¡Œä¸‹ä¸€é˜¶æ®µ

7. å¯¼å‡ºç»“æœ
   â”œâ”€> POST /api/sessions/{session_id}/exports/xmind
   â”œâ”€> ä» SessionResult è¡¨è¯»å–æ•°æ®
   â”œâ”€> ä½¿ç”¨ XMind å¯¼å‡ºå™¨ç”Ÿæˆæ–‡ä»¶
   â””â”€> è¿”å›äºŒè¿›åˆ¶æ–‡ä»¶æµ
```

---

## ğŸš€ å¯æ‰©å±•æ€§è®¾è®¡

### 1. å¦‚ä½•æ·»åŠ æ–°æ™ºèƒ½ä½“ï¼Ÿ

**æ­¥éª¤**:

1. **å®šä¹‰æ™ºèƒ½ä½“é…ç½®**:
```python
# config.py
class Settings(BaseSettings):
    # æ–°æ™ºèƒ½ä½“é…ç½®
    security_agent_model: str = "qwen3-next-80b-a3b-instruct"
    security_agent_api_key: str | None = None
    security_agent_base_url: str | None = None
```

2. **åˆ›å»ºæ™ºèƒ½ä½“Prompt**:
```python
# llm/autogen_runner.py
SECURITY_SYSTEM_MESSAGE = """ä½ æ˜¯ä¸€ä½å®‰å…¨æµ‹è¯•ä¸“å®¶ã€‚æ ¹æ®éœ€æ±‚åˆ†æç»“æœï¼Œè¯†åˆ«æ½œåœ¨çš„å®‰å…¨é£é™©å¹¶ç”Ÿæˆå®‰å…¨æµ‹è¯•ç”¨ä¾‹ã€‚"""

def run_security_testing(analysis_payload: dict) -> tuple[dict, str]:
    agent = _agent(SECURITY_SYSTEM_MESSAGE, agent_type="security")
    prompt = f"è¯·åˆ†æä»¥ä¸‹éœ€æ±‚çš„å®‰å…¨é£é™©ï¼š{analysis_payload}"
    content = _generate(agent, prompt)
    payload = _extract_json(content)
    return payload, content
```

3. **é›†æˆåˆ°å·¥ä½œæµ**:
```python
# orchestrator/workflow.py
class AgentStage(str, enum.Enum):
    # ...
    security_testing = "security_testing"

async def execute(self) -> None:
    # ... ç°æœ‰é˜¶æ®µ ...
    
    # æ–°é˜¶æ®µï¼šå®‰å…¨æµ‹è¯•
    security_payload, _ = await asyncio.to_thread(
        run_security_testing, analysis_payload
    )
    await self._handle_stage_result(
        AgentStage.security_testing,
        security_payload,
        progress=0.85,
        needs_confirmation=True,
    )
```

4. **æ›´æ–°å‰ç«¯**:
```typescript
// æ·»åŠ é˜¶æ®µå®šä¹‰
const STAGES = [
  // ...
  { key: 'security_testing', title: 'å®‰å…¨æµ‹è¯•' },
];

// æ·»åŠ è§†å›¾ç»„ä»¶
const SecurityTestingView: React.FC<{ payload }> = ({ payload }) => {
  // æ¸²æŸ“å®‰å…¨æµ‹è¯•ç»“æœ
};
```

---

### 2. å¦‚ä½•æ”¯æŒæ–°LLMæ¨¡å‹ï¼Ÿ

**æ­¥éª¤**:

1. **æ·»åŠ æ¨¡å‹é…ç½®**ï¼ˆå¦‚æœéœ€è¦ç‰¹æ®ŠAPIï¼‰:
```python
# config.py
class Settings(BaseSettings):
    llm_provider: Literal["qwen", "openai", "claude"] = "qwen"
    
    claude_api_key: str | None = None
    claude_base_url: str = "https://api.anthropic.com/v1"
```

2. **åˆ›å»ºå®¢æˆ·ç«¯é€‚é…å™¨**ï¼ˆå¦‚æœAPIä¸å…¼å®¹OpenAIï¼‰:
```python
# llm/claude_client.py
class ClaudeClient:
    def chat_completion(self, messages: list[dict]) -> str:
        # è°ƒç”¨Claude API
        pass
```

3. **æ›´æ–°AutoGené…ç½®**:
```python
# llm/autogen_runner.py
def _agent(system_message: str, agent_type: str) -> AssistantAgent:
    if settings.llm_provider == "claude":
        # ä½¿ç”¨Claudeé€‚é…å™¨
        config = {
            "model": "claude-3-opus",
            "api_key": settings.claude_api_key,
            "base_url": settings.claude_base_url,
        }
    else:
        # ä½¿ç”¨OpenAIå…¼å®¹é…ç½®
        config = settings.get_agent_config(agent_type)
    
    return AssistantAgent(...)
```

---

### 3. å¦‚ä½•æ”¯æŒæ–°æ–‡æ¡£ç±»å‹ï¼Ÿ

**æ­¥éª¤**:

1. **æ·»åŠ è§£æå™¨**:
```python
# parsers/text_extractor.py
def extract_text(file_path: str) -> str:
    suffix = Path(file_path).suffix.lower()
    
    if suffix == '.md':
        # Markdownè§£æ
        return parse_markdown(file_path)
    elif suffix == '.xlsx':
        # Excelè§£æ
        return parse_excel(file_path)
    # ...
```

2. **æ›´æ–°å‰ç«¯æ–‡ä»¶ç±»å‹é™åˆ¶**:
```typescript
// components/FileUploader.tsx
const { getRootProps, getInputProps } = useDropzone({
  accept: {
    'application/pdf': ['.pdf'],
    'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],
    'text/markdown': ['.md'],  // æ–°å¢
    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx'],  // æ–°å¢
  },
});
```

---

## ğŸ”’ å®‰å…¨æ€§è€ƒè™‘

### 1. æ–‡ä»¶ä¸Šä¼ å®‰å…¨

**å¨èƒ**:
- æ¶æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆç—…æ¯’ã€æœ¨é©¬ï¼‰
- è·¯å¾„éå†æ”»å‡»
- æ–‡ä»¶åæ³¨å…¥

**é˜²æŠ¤æªæ–½**:
```python
# api/uploads.py
async def upload_document(file: UploadFile):
    # 1. æ–‡ä»¶å¤§å°é™åˆ¶
    if file.size > settings.max_file_size:
        raise HTTPException(400, "æ–‡ä»¶è¿‡å¤§")
    
    # 2. æ–‡ä»¶ç±»å‹ç™½åå•
    allowed_types = ['.pdf', '.docx', '.png', '.jpg']
    suffix = Path(file.filename).suffix.lower()
    if suffix not in allowed_types:
        raise HTTPException(400, "ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹")
    
    # 3. æ–‡ä»¶åæ¸…ç†ï¼ˆé˜²æ­¢è·¯å¾„éå†ï¼‰
    safe_filename = secure_filename(file.filename)
    
    # 4. ä½¿ç”¨UUIDä½œä¸ºå­˜å‚¨æ–‡ä»¶åï¼ˆé˜²æ­¢å†²çªå’ŒçŒœæµ‹ï¼‰
    storage_path = settings.resolved_upload_dir / f"{uuid4()}_{safe_filename}"
    
    # 5. ç—…æ¯’æ‰«æï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰
    # scan_file_for_virus(content)
```

---

### 2. API è®¤è¯ä¸æˆæƒ

**å½“å‰çŠ¶æ€**: æ— è®¤è¯ï¼ˆé€‚åˆå†…éƒ¨éƒ¨ç½²ï¼‰

**ç”Ÿäº§ç¯å¢ƒå»ºè®®**:
```python
# æ·»åŠ JWTè®¤è¯
from fastapi.security import HTTPBearer

security = HTTPBearer()

@router.post("/sessions")
async def create_session(
    payload: SessionCreateRequest,
    token: str = Depends(security),
):
    # éªŒè¯token
    user = verify_jwt_token(token)
    
    # åˆ›å»ºä¼šè¯
    session = await session_repository.create(
        db,
        document_ids=payload.document_ids,
        created_by=user.id,  # è®°å½•åˆ›å»ºè€…
    )
```

---

### 3. æ•æ„Ÿä¿¡æ¯å¤„ç†

**å¨èƒ**: API Keyæ³„éœ²ã€ç”¨æˆ·æ•°æ®æ³„éœ²

**é˜²æŠ¤æªæ–½**:
```python
# 1. ä¸è®°å½•æ•æ„Ÿä¿¡æ¯åˆ°æ—¥å¿—
logger.info(f"LLMè°ƒç”¨æˆåŠŸï¼Œæ¨¡å‹: {model}")  # âœ…
# logger.info(f"API Key: {api_key}")  # âŒ

# 2. ç¯å¢ƒå˜é‡å­˜å‚¨API Key
# .env
QWEN_API_KEY=sk-xxxxx

# .gitignore
.env

# 3. æ•°æ®åº“å­—æ®µåŠ å¯†ï¼ˆå¦‚æœå­˜å‚¨ç”¨æˆ·æ•æ„Ÿæ•°æ®ï¼‰
from cryptography.fernet import Fernet

encrypted_data = fernet.encrypt(sensitive_data.encode())
```

---

### 4. CSRF é˜²æŠ¤

**å½“å‰çŠ¶æ€**: æ— CSRFé˜²æŠ¤ï¼ˆå› ä¸ºæ— Cookieè®¤è¯ï¼‰

**å¦‚æœä½¿ç”¨Cookieè®¤è¯ï¼Œéœ€è¦æ·»åŠ **:
```python
from fastapi_csrf_protect import CsrfProtect

app.add_middleware(
    CsrfProtect,
    secret_key="your-secret-key",
)
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

**é—®é¢˜**: N+1æŸ¥è¯¢é—®é¢˜

**ä¼˜åŒ–**:
```python
# âŒ é”™è¯¯ï¼šN+1æŸ¥è¯¢
sessions = await session_repository.get_all(db)
for session in sessions:
    documents = await document_repository.get_by_session(db, session.id)  # Næ¬¡æŸ¥è¯¢

# âœ… æ­£ç¡®ï¼šä½¿ç”¨selectinåŠ è½½
class Session(Base):
    documents: Mapped[list[Document]] = relationship(
        "Document",
        secondary=session_documents,
        lazy="selectin",  # ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰å…³è”æ–‡æ¡£
    )
```

---

### 2. Redisç¼“å­˜ç­–ç•¥

**ç¼“å­˜å†…å®¹**:
- VLæ¨¡å‹è¯†åˆ«ç»“æœï¼ˆç›¸åŒchecksumä¸é‡å¤è¯†åˆ«ï¼‰
- WebSocketäº‹ä»¶ï¼ˆæ”¯æŒæ–­çº¿é‡è¿ï¼‰
- ä¼šè¯çŠ¶æ€ï¼ˆé¿å…é¢‘ç¹æŸ¥è¯¢æ•°æ®åº“ï¼‰

**å®ç°**:
```python
# cache/image_cache.py
async def get_or_compute_vl_result(file_path: Path, checksum: str) -> str:
    # 1. å°è¯•ä»ç¼“å­˜è¯»å–
    cache_key = f"vl_result:{checksum}"
    cached = await redis_client.get(cache_key)
    if cached:
        return cached
    
    # 2. ç¼“å­˜æœªå‘½ä¸­ï¼Œè°ƒç”¨VLæ¨¡å‹
    result = await analyze_with_multimodal(file_path, ...)
    
    # 3. å­˜å‚¨åˆ°ç¼“å­˜ï¼ˆ24å°æ—¶è¿‡æœŸï¼‰
    await redis_client.setex(cache_key, 86400, result)
    
    return result
```

---

### 3. å¹¶å‘æ§åˆ¶

**é—®é¢˜**: å¤§é‡å¹¶å‘å·¥ä½œæµå¯¼è‡´èµ„æºè€—å°½

**ä¼˜åŒ–**:
```python
# orchestrator/workflow.py
import asyncio

# å…¨å±€ä¿¡å·é‡é™åˆ¶å¹¶å‘æ•°
MAX_CONCURRENT_WORKFLOWS = 5
workflow_semaphore = asyncio.Semaphore(MAX_CONCURRENT_WORKFLOWS)

class AnalysisWorkflow:
    async def launch(self, session_id: str) -> None:
        async with workflow_semaphore:  # é™åˆ¶å¹¶å‘
            await self._run(session_id)
```

---

### 4. å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**ä¼˜åŒ–ç‚¹**:

1. **Zustandé€‰æ‹©å™¨ä¼˜åŒ–**:
```typescript
// âŒ é”™è¯¯ï¼šæ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“
const { agentResults, selectedStage } = useAppStore();

// âœ… æ­£ç¡®ï¼šåªè®¢é˜…éœ€è¦çš„æ•°æ®
const agentResults = useAppStore(state => state.agentResults);
const selectedStage = useAppStore(state => state.selectedStage);
```

2. **React.memoåŒ…è£…çº¯ç»„ä»¶**:
```typescript
const TestCasesView = React.memo<Props>(({ payload }) => {
  // åªæœ‰payloadå˜åŒ–æ—¶æ‰é‡æ–°æ¸²æŸ“
});
```

3. **è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§é‡æµ‹è¯•ç”¨ä¾‹ï¼‰**:
```typescript
import { FixedSizeList } from 'react-window';

const VirtualizedTestCases: React.FC<{ cases }> = ({ cases }) => (
  <FixedSizeList
    height={600}
    itemCount={cases.length}
    itemSize={50}
  >
    {({ index, style }) => (
      <div style={style}>{cases[index].title}</div>
    )}
  </FixedSizeList>
);
```

---

## ğŸ“Š ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### å»ºè®®æ·»åŠ çš„ç›‘æ§æŒ‡æ ‡

1. **ä¸šåŠ¡æŒ‡æ ‡**:
   - æ¯å¤©ä¸Šä¼ æ–‡æ¡£æ•°é‡
   - æ¯å¤©åˆ›å»ºä¼šè¯æ•°é‡
   - ä¼šè¯æˆåŠŸç‡ï¼ˆcompleted / totalï¼‰
   - å¹³å‡æ¯ä¸ªé˜¶æ®µè€—æ—¶

2. **æŠ€æœ¯æŒ‡æ ‡**:
   - LLM APIè°ƒç”¨æ¬¡æ•°å’Œå¤±è´¥ç‡
   - WebSocketè¿æ¥æ•°
   - Redisç¼“å­˜å‘½ä¸­ç‡
   - æ•°æ®åº“æŸ¥è¯¢è€—æ—¶

3. **æ—¥å¿—èšåˆ**:
   - ä½¿ç”¨ELK Stackï¼ˆElasticsearch + Logstash + Kibanaï¼‰
   - æˆ–ä½¿ç”¨äº‘æœåŠ¡ï¼ˆå¦‚é˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡ï¼‰

---

**æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æå‡ºæ”¹è¿›å»ºè®®ï¼**
